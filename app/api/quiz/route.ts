import { NextRequest, NextResponse } from 'next/server'; import { serverClient } from '@/lib/supabase';
export async function GET(req: NextRequest){ const date=req.nextUrl.searchParams.get('date'); if(!date) return NextResponse.json({error:'Missing date'},{status:400}); const sb=serverClient(); const { data: quiz }=await sb.from('quizzes').select('id, quiz_date, title, status').eq('quiz_date',date).eq('status','published').single(); if(!quiz) return NextResponse.json({error:'Not found'},{status:404}); const { data: questions }=await sb.from('questions').select('id, idx, type, prompt, options, explanation').eq('quiz_id',quiz.id).order('idx'); return NextResponse.json({ ...quiz, questions }); }
